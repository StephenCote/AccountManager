<?xml version="1.0" encoding="utf-8" ?>
<Template>
	<p>Profile ...</p>
	<embedded-script>
		<![CDATA[
			template_init: function(){
				var oU = 0;
				
				/// The link is specifically for the master person/user at the organization level
				///
				var sLinkProfId = 0;
				
				if(this.getProperties().viewType && this.getProperties().listType){
					oU = this.getProperties().viewType;
					this.getProperties().profileType = this.getProperties().listType;
				}
				else oU = uwm.getUser();
				if(oU.nameType == "USER"){
					var oP = AM6Client.userPerson(oU.objectId);
					if(oP){
						sLinkProfId = oU.objectId;
						oU = oP;
						this.getProperties().profileType = "Person";
					}
					else{
						this.getProperties().profileType = "User";
					}
					
				}
				/// If the person includes a user ...
				else if(oU.nameType == "PERSON" && oU.users.length > 0){
					sLinkProfId = oU.users[0].objectId;
				}
				if(oU){
					this.getProperties().profileId = oU.objectId;
					this.getProperties().linkProfileId = sLinkProfId;
					this.loadTemplate("/AccountManagerService/Forms/ProfileFields.xml");
				}
			}
			
		]]>
	</embedded-script>
</Template>